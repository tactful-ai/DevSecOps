FROM alpine:3.15.3

WORKDIR /app

RUN apk add --no-cache wget
RUN mkdir -p /app/scan-results
RUN wget -O /usr/local/bin/kubectl https://storage.googleapis.com/kubernetes-release/release/v1.22.2/bin/linux/amd64/kubectl
RUN chmod +x /usr/local/bin/kubectl

COPY trivy_linux_amd64 /usr/local/bin/trivy
COPY kube-bench /app/
COPY kube-hunter /app/
COPY kubescape /app/

COPY scan.sh .

RUN chmod +x scan.sh
RUN chmod +x /usr/local/bin/trivy

CMD ["./scan.sh"]

